services:
  # ğŸŒ Web (chá»‰ phá»¥c vá»¥ dashboard, KHÃ”NG post X)
  - type: web
    name: dobby-news-web
    env: python
    region: oregon
    plan: free
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
    startCommand: |
      gunicorn -w 2 -b 0.0.0.0:$PORT web_server:app
    envVars:
      - key: PYTHON_VERSION
        value: 3.11
      - key: NEWS_AUTO_POST
        value: "false" # web khÃ´ng post X
      - key: NEWS_MIN_INTERVAL_SEC
        value: "3600"
      # â€”â€” LLM/Search (chá»‰ cáº§n cho summarize/deep analyze trÃªn web) â€”â€”
      - key: FIREWORKS_API_KEY
        sync: false
      - key: FIREWORKS_MODEL
        value: accounts/sentientfoundation/models/dobby-unhinged-llama-3-3-70b-new
      - key: SERPER_API_KEY
        sync: false
      - key: JINA_API_KEY
        sync: false
    disk:
      name: data
      mountPath: data # mount relative Ä‘á»ƒ khá»›p Path("data")
      sizeGB: 1

  # âš™ï¸ Worker (tá»± Ä‘á»™ng quÃ©t & Ä‘Äƒng X)
  - type: worker
    name: dobby-news-worker
    env: python
    region: oregon
    plan: free
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
    startCommand: |
      ./.venv/bin/python news_runner.py --loop
    numInstances: 1
    envVars:
      - key: PYTHON_VERSION
        value: 3.11

      # â€”â€”â€” NEWS config â€”â€”â€”
      - key: NEWS_AUTO_POST
        value: "true" # worker lÃ  nÆ¡i post
      - key: NEWS_MIN_INTERVAL_SEC
        value: "3600" # 1 giá»/láº§n
      - key: NEWS_MAX_ARTICLES_PER_UPDATE
        value: "1" # má»—i vÃ²ng Ä‘Äƒng 1 bÃ i
      - key: NEWS_CATEGORIES
        value: tech,crypto,ai # tuá»³ báº¡n

      # â€”â€”â€” Twitter (báº¯t buá»™c) â€”â€”â€”
      - key: TWITTER_CONSUMER_KEY
        sync: false
      - key: TWITTER_CONSUMER_SECRET
        sync: false
      - key: TWITTER_ACCESS_TOKEN
        sync: false
      - key: TWITTER_ACCESS_TOKEN_SECRET
        sync: false
      - key: TWITTER_BEARER_TOKEN
        sync: false

      # â€”â€”â€” LLM (nÃªn cÃ³ Ä‘á»ƒ tweet mÆ°á»£t hÆ¡n) â€”â€”â€”
      - key: FIREWORKS_API_KEY
        sync: false
      - key: FIREWORKS_MODEL
        value: accounts/sentientfoundation/models/dobby-unhinged-llama-3-3-70b-new

      # â€”â€”â€” (tuá»³ chá»n, khÃ´ng áº£nh hÆ°á»Ÿng Worker) â€”â€”â€”
      - key: SERPER_API_KEY
        sync: false
      - key: JINA_API_KEY
        sync: false
    disk:
      name: data
      mountPath: data # mount relative Ä‘á»ƒ khá»›p Path("data")
      sizeGB: 1
